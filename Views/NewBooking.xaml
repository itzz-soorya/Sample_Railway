<UserControl x:Class="UserModule.NewBooking"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             
             xmlns:comp="clr-namespace:UserModule.Components"
             HorizontalAlignment="Stretch"
             VerticalAlignment="Stretch"
             MinWidth="600"
             MinHeight="500"
             MaxHeight="{Binding Source={x:Static SystemParameters.WorkArea}, Path=Height}"
             Loaded="UserControl_Loaded"
             Unloaded="UserControl_Unloaded"
             PreviewMouseWheel="UserControl_PreviewMouseWheel">
    <UserControl.Resources>
        <!-- Style for rounded TextBox with visible border and watermark -->
        <Style x:Key="RoundedWatermarkTextBoxStyle" TargetType="TextBox">
            <Setter Property="BorderBrush" Value="#999999"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,0"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="Bd"
                                CornerRadius="4"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <Grid>
                                <ScrollViewer x:Name="PART_ContentHost"/>
                                <TextBlock x:Name="Watermark"
                                           Text="{TemplateBinding Tag}"
                                           Foreground="#333"
                                           Margin="14,0,0,0"
                                           VerticalAlignment="Center"
                                           IsHitTestVisible="False"
                                           Opacity="0.6"
                                           Visibility="Collapsed"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsFocused" Value="False"/>
                                    <Condition Property="Text" Value=""/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Watermark" Property="Visibility" Value="Visible"/>
                            </MultiTrigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="Watermark" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style for ComboBox with white background -->
        <Style x:Key="WhiteComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#999999"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton" 
                                          Background="White"
                                          BorderBrush="#999999"
                                          BorderThickness="1"
                                          Focusable="False"
                                          IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                          ClickMode="Press">
                                <ToggleButton.Style>
                                    <Style TargetType="ToggleButton">
                                        <Setter Property="Background" Value="White"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ToggleButton">
                                                    <Border Background="White" 
                                                            BorderBrush="#999999" 
                                                            BorderThickness="1"
                                                            CornerRadius="4">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition/>
                                                                <ColumnDefinition Width="30"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Path x:Name="Arrow" Grid.Column="1"
                                                                  Fill="#666" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                                  Data="M 0 0 L 4 4 L 8 0 Z"/>
                                                        </Grid>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ToggleButton.Style>
                            </ToggleButton>
                            <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                              Margin="{TemplateBinding Padding}"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Left"/>
                            <Popup x:Name="Popup"
                                Placement="Bottom"
                                PlacementTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                IsOpen="{TemplateBinding IsDropDownOpen}"
                                AllowsTransparency="True"
                                Focusable="False"
                                PopupAnimation="Slide">

                                <Grid x:Name="DropDown" SnapsToDevicePixels="True"
                                      MinWidth="{TemplateBinding ActualWidth}"
                                      MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder" Background="White" 
                                            BorderThickness="1" BorderBrush="#999999"
                                            CornerRadius="4"/>
                                    <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"
                                                    Background="White"/>
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style for ComboBox Items with white background -->
        <Style x:Key="WhiteComboBoxItemStyle" TargetType="ComboBoxItem">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter TextElement.Foreground="{TemplateBinding Foreground}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F0F0F0"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#E6F0FE"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Foreground" Value="#999999"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style for Primary Button with Hover Effect -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#232323"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="4"
                                BorderThickness="0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border"
                                                          Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                          To="#3A3A3A"
                                                          Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border"
                                                          Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                          To="#232323"
                                                          Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#1A1A1A"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#CCCCCC"/>
                                <Setter Property="Foreground" Value="#999999"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style for Cancel Button with Hover Effect -->
        <Style x:Key="CancelButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#BDBCBC"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="4"
                                BorderThickness="0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border"
                                                          Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                          To="#A5A4A4"
                                                          Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border"
                                                          Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                          To="#BDBCBC"
                                                          Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#8D8C8C"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" MaxHeight="{Binding Source={x:Static SystemParameters.WorkArea}, Path=Height}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Main Content Area -->
        <Grid Grid.Row="0" Background="#F7F7F7" Margin="0,10,0,20" VerticalAlignment="Top">
            <Border Background="#232323" CornerRadius="8" Padding="20" Margin="24,10,20,10" VerticalAlignment="Top">
                <Grid>
                    <!-- Two columns: left for title, right for Booking ID -->
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- Left side: Title and subtitle -->
                    <StackPanel Orientation="Vertical" Grid.Column="0">
                        <TextBlock Text="Add New Booking"
                       FontSize="22"
                       FontWeight="Bold"
                       Foreground="White"/>
                        <TextBlock Text="Fill in the details to create a new booking entry"
                       FontSize="13"
                       Foreground="#F7F7F7"
                       Margin="0,6,0,0"/>
                    </StackPanel>

                    <!-- Right side: Booking ID -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="20,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="Booking ID"
                             FontWeight="SemiBold"
                             FontSize="14"
                             Foreground="White"
                             VerticalAlignment="Center"
                             Margin="0,0,10,0"
                             Visibility="Collapsed"
                        />
                        <TextBox x:Name="txtBookingID"
                            Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                            Tag="Booking ID"
                            Foreground="#333333"
                            Background="White"
                            Height="40"
                            Width="180"
                            IsReadOnly="True"
                            BorderThickness="0"
                            Padding="10,0"
                            Visibility="Collapsed"/>
                    </StackPanel>
                </Grid>
            </Border>

        </Grid>
        <!-- FORM -->
        <Border Grid.Row="1" Background="White" CornerRadius="8" Padding="30" Margin="20,0,20,20">
            <ScrollViewer x:Name="FormScrollViewer"
                          VerticalScrollBarVisibility="Hidden" 
                          HorizontalScrollBarVisibility="Hidden"
                          PanningMode="VerticalFirst"
                          CanContentScroll="False"
                          IsDeferredScrollingEnabled="False"
                          Padding="0,0,0,0"
                          BorderThickness="0">
                <!-- Main content grid (your booking form) -->
                <Grid x:Name="MainContentGrid" Margin="0,0,0,20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Text="Customer Info"
                     FontWeight="SemiBold"
                     FontSize="16"
                     Foreground="#333"
                     Grid.Row="0"
                     Grid.Column="0"
                     Grid.ColumnSpan="2"
                     HorizontalAlignment="Left"
                     Margin="0,0,0,12"/>
                    
                    <!-- First Name -->
                    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,15,20">
                        <TextBlock Text="First Name"
                   FontWeight="SemiBold"
                   FontSize="14"
                   Foreground="#333"
                   Margin="0,0,0,8"/>
                        <TextBox x:Name="txtFirstName"
                 Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                 Tag="Enter first name"
                 Height="40"
                 Foreground="Black"
                 FontWeight="DemiBold"
                 PreviewKeyDown="Control_PreviewKeyDown"
                 PreviewTextInput="UppercaseOnly_PreviewTextInput"
                 DataObject.Pasting="UppercaseOnly_Pasting"
                 TextChanged="CustomerName_TextChanged"/>
                        <TextBlock x:Name="errCustomer"
                   Text="* Fill the first Customer Name"
                   Foreground="#CC1F1F"
                   FontSize="12"
                   Visibility="Collapsed"
                   Margin="5,2,0,0"/>
                    </StackPanel>

                    <!-- Hidden combined field -->
                    <TextBox x:Name="txtCustomer" Visibility="Collapsed"/>

                    <!-- Phone Number -->
                    <StackPanel Grid.Row="1" Grid.Column="1" Margin="15,0,0,20" Background="Transparent">
                        <TextBlock Text="Phone Number" FontWeight="SemiBold" FontSize="14" Foreground="#333" Margin="0,0,0,8"/>
                        <TextBox x:Name="txtPhone" Style="{StaticResource RoundedWatermarkTextBoxStyle}" Tag="+91 902 543 xxxx" Foreground="Black" FontWeight="DemiBold" Height="40"  MaxLength="10" PreviewKeyDown="Control_PreviewKeyDown" PreviewTextInput="NumbersOnly_PreviewTextInput" DataObject.Pasting="NumbersOnly_Pasting"/>
                        <TextBlock x:Name="errPhone" Text="* Fill Phone Number" Foreground="#CC1F1F" FontSize="12" Visibility="Collapsed" Margin="5,2,0,0"/>
                    </StackPanel>
                    
                    <!-- Booking Details Section - Number of Persons, Seat Type, Total Hours in one row -->
                    <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Margin="0,0,0,20" HorizontalAlignment="Stretch" Background="Transparent">
                        <!-- Responsive Grid for Number of Persons, Seat Type, Total Hours -->
                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Top">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- Number of Persons -->
                            <StackPanel Grid.Column="0" Margin="0,0,15,12" Background="Transparent">
                                <TextBlock Text="Number of Persons" FontWeight="SemiBold" FontSize="14" Foreground="#333" Margin="0,0,0,8"/>
                                <TextBox x:Name="txtPersons" Style="{StaticResource RoundedWatermarkTextBoxStyle}" Tag="Enter number" Foreground="Black" FontWeight="DemiBold" Height="40" PreviewKeyDown="Control_PreviewKeyDown" PreviewTextInput="NumbersOnly_PreviewTextInput" DataObject.Pasting="NumbersOnly_Pasting"/>
                                <TextBlock x:Name="errPersons" Text="* Fill Number of Persons" Foreground="#CC1F1F" FontSize="12" Visibility="Collapsed" Margin="5,2,0,0"/>
                            </StackPanel>

                            <!-- Seat Type -->
                            <StackPanel Grid.Column="1" Margin="0,0,15,12">
                                <TextBlock Text="Seat Type" FontWeight="SemiBold" FontSize="14" Foreground="#333" Margin="0,0,0,8"/>
                                <ComboBox x:Name="txtSeats"
                                 Height="40"
                                 Padding="10,0"
                                 FontSize="14"
                                 PreviewKeyDown="Control_PreviewKeyDown"
                                 Foreground="Black" FontWeight="DemiBold"
                                 Background="White"
                                 HorizontalContentAlignment="Left"
                                 VerticalContentAlignment="Center"
                                 Style="{StaticResource WhiteComboBoxStyle}"
                                 SelectionChanged="txtSeats_SelectionChanged">
                                    <!-- Items are populated dynamically based on API response -->
                                </ComboBox>
                                <TextBlock x:Name="errSeats" Text="* Select Seat Type" Foreground="#CC1F1F" FontSize="12" Visibility="Collapsed" Margin="5,2,0,0"/>
                            </StackPanel>

                            <!-- Total Hours -->
                            <StackPanel Grid.Column="2" Margin="0,0,0,12">
                                <TextBlock Text="Total Hours" FontWeight="SemiBold" FontSize="14" Foreground="#333" Margin="0,0,0,8"/>
                                <ComboBox x:Name="txtHours"
                                    Height="40"
                                    Padding="10,0"
                                    FontSize="14"
                                    PreviewKeyDown="Control_PreviewKeyDown"
                                    Foreground="Black" FontWeight="DemiBold"
                                    Background="White"
                                    HorizontalContentAlignment="Left"
                                    VerticalContentAlignment="Center"
                                    MaxDropDownHeight="250"
                                    Style="{StaticResource WhiteComboBoxStyle}"
                                    SelectionChanged="txtHours_SelectionChanged"
                                    DropDownOpened="txtHours_DropDownOpened">
                                    <ComboBoxItem x:Name="hoursPlaceholder" Content="Select hours" IsEnabled="False" Style="{StaticResource WhiteComboBoxItemStyle}" IsSelected="True"/>
                                    <ComboBoxItem Content="1 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="2 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="3 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="4 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="5 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="6 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="7 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="8 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="9 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="10 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="11 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="12 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                </ComboBox>

                                <TextBlock x:Name="errHours" Text="* Select Total Hours" Foreground="#CC1F1F" FontSize="12" Visibility="Collapsed" Margin="5,2,0,0"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>

                    <!-- Pricing Info -->
                    <StackPanel Grid.Row="6" Grid.ColumnSpan="2" Margin="0,0,0,30" Background="Transparent">
                        <!-- <TextBlock Text="Pricing Information" FontWeight="SemiBold" FontSize="14" Foreground="#222" Margin="0,0,0,14"/> -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Price per Person -->
                            <StackPanel Grid.Column="0" Margin="0,0,10,0" Background="Transparent" Visibility="Collapsed">
                                <TextBlock Text="Price per Person (₹)" FontSize="13" FontWeight="SemiBold" Foreground="#333" Margin="0,0,0,8"/>
                                <TextBox x:Name="txtRate"
                                    Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                                    Foreground="Black" FontWeight="DemiBold"
                                    Tag="0"
                                    Height="40"
                                    IsReadOnly="True"
                                    IsReadOnlyCaretVisible="False"
                                    Background="white"
                                    BorderBrush="#CCCCCC"
                                    Cursor="Arrow" />
                            </StackPanel>
                            
                            <!-- Total Amount -->
                            <StackPanel Grid.Column="1" Margin="10,0,10,0" Background="Transparent" Visibility="Collapsed">
                                <TextBlock Text="Total Amount (₹)" FontSize="13" FontWeight="SemiBold" Foreground="#333" Margin="0,0,0,8"/>
                                <TextBox x:Name="txtTotalAmount"
                                    Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                                    Foreground="Black" FontWeight="DemiBold"
                                    Tag="0"
                                    Height="40"
                                    IsReadOnly="True"
                                    IsReadOnlyCaretVisible="False"
                                    Background="White"
                                    BorderBrush="#CCCCCC"
                                    Cursor="Arrow" />
                            </StackPanel>
                            
                            <!-- Discount Amount -->
                            <StackPanel Grid.Column="2" Margin="10,0,10,0" Background="Transparent" Visibility="Collapsed">
                                <TextBlock Text="Discount (₹)" FontSize="13" FontWeight="SemiBold" Foreground="#333" Margin="0,0,0,8"/>
                                <TextBox x:Name="txtDiscount" 
                                    Style="{StaticResource RoundedWatermarkTextBoxStyle}" 
                                    Foreground="Black" FontWeight="DemiBold" 
                                    Tag="0" 
                                    Height="40" 
                                    PreviewTextInput="NumbersOnly_PreviewTextInput" 
                                    PreviewKeyDown="Control_PreviewKeyDown"
                                    DataObject.Pasting="NumbersOnly_Pasting"
                                    TextChanged="txtDiscount_TextChanged"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                    <!-- Proof Information -->
                    <Grid Grid.Row="4" Grid.ColumnSpan="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        
                        <!-- First Proof Field: ID Type -->
                        <Grid Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,0,10,0">
                            <StackPanel Background="Transparent">
                                <TextBlock Text="Proof Information" FontWeight="SemiBold" FontSize="16" Foreground="#333" Margin="0,0,0,12"/>
                                <TextBlock Text="ID Type" FontWeight="SemiBold" FontSize="14" Foreground="#333" Margin="0,0,0,8"/>
                                <ComboBox x:Name="cmbIdType"
                                         Height="40"
                                         Padding="10,0"
                                         FontSize="14"
                                         Foreground="Black"
                                         FontWeight="DemiBold"
                                         Background="White"
                                         HorizontalContentAlignment="Left"
                                         VerticalContentAlignment="Center"
                                         MaxDropDownHeight="150"
                                         PreviewKeyDown="IdType_PreviewKeyDown"
                                         Style="{StaticResource WhiteComboBoxStyle}"
                                         SelectionChanged="cmbIdType_SelectionChanged">
                                    <ComboBoxItem x:Name="idPlaceholder" Content="Select ID" IsEnabled="False" IsSelected="True"/>
                                    <ComboBoxItem Content="Aadhar" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="PNR Number" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                    <ComboBoxItem Content="PAN ID" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                </ComboBox>
                                <TextBlock x:Name="errIdType" Text="* Select ID Type" Foreground="#CC1F1F" FontSize="12" Visibility="Collapsed" Margin="5,2,0,0"/>
                            </StackPanel>
                        </Grid>

                        <!-- Second Proof Field: Dynamic Input -->
                        <Grid Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="10,0,0,0">
                            <StackPanel Background="Transparent">
                                <TextBlock x:Name="lblIdInput" Text="Enter ID Number" FontWeight="SemiBold" FontSize="14" Foreground="#333" Margin="0,30,0,8"/>
                                <TextBox x:Name="txtIdNumber"
                                        Foreground="Black" FontWeight="DemiBold"
                                        Style="{StaticResource RoundedWatermarkTextBoxStyle}" 
                                        Tag="ID Number" 
                                        Height="40"
                                        TextWrapping="NoWrap"
                                        AcceptsReturn="False"
                                        IsEnabled="False"
                                        PreviewKeyDown="IdNumber_PreviewKeyDown"
                                        PreviewTextInput="NumbersOnly_PreviewTextInput"
                                        DataObject.Pasting="NumbersOnly_Pasting"/>
                                <TextBlock x:Name="errIdNumber" Text="* Fill ID Number" Foreground="#CC1F1F" FontSize="12" Visibility="Collapsed" Margin="5,2,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Grid>

                    <!-- Submit / Cancel Buttons -->
                    <Grid Grid.Row="5" Grid.ColumnSpan="2" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,20,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                            <Button x:Name="GenerateBillButton" 
                                    Content="Generate Bill" 
                                    Width="249" 
                                    Height="40" 
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Margin="0,0,10,0" 
                                    Click="GenerateBill_Click"/>
                            <Button x:Name="CancelButton" 
                                    Content="Cancel" 
                                    Width="243" 
                                    Height="40" 
                                    Style="{StaticResource CancelButtonStyle}"
                                    Click="Cancel_Click"/>
                        </StackPanel>
                    </Grid>

                    <!-- Booking Date and Time Row -->
                    <StackPanel Grid.Row="6" Grid.ColumnSpan="2" Margin="0,0,0,20" HorizontalAlignment="Stretch" Background="Transparent" Visibility="Collapsed">
                        <!-- Responsive Grid for Date and Time -->
                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Top">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- Booking Date -->
                            <StackPanel Grid.Column="0" Margin="0,0,15,12" Background="Transparent">
                                <TextBlock Text="Date" FontWeight="SemiBold" FontSize="14" Foreground="#333" Margin="0,0,0,8"/>
                                <TextBox x:Name="txtBookingDate"
                                 Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                                 Foreground="Black" FontWeight="DemiBold"
                                 Height="40"  
                                 HorizontalAlignment="Stretch"
                                 IsReadOnly="True"
                                 Visibility="Collapsed"/>
                            </StackPanel>

                            <!-- Booking Time -->
                            <StackPanel Grid.Column="1" Margin="0,0,0,12" Background="Transparent">
                                <TextBlock Text="Time" FontWeight="SemiBold" FontSize="14" Foreground="#333" Margin="0,0,0,8"/>
                                <TextBox x:Name="txtBookingTime"
                                 Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                                 Foreground="Black" FontWeight="DemiBold"
                                 Tag="HH:MM"
                                 Height="40"
                                 HorizontalAlignment="Stretch"
                                 IsReadOnly="True"
                                 Visibility="Collapsed"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Grid>
            </ScrollViewer>
        </Border>

        <!-- Loading Overlay -->
        <Grid x:Name="LoaderOverlay"
              Grid.RowSpan="2"
              Background="#80000000"
              Visibility="Collapsed"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch"
              Panel.ZIndex="999">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <ProgressBar Width="200" Height="10" IsIndeterminate="True"/>
                <TextBlock Text="Generating Bill..." Foreground="White" FontSize="16" HorizontalAlignment="Center" Margin="0,10,0,0"/>
            </StackPanel>
        </Grid>

        <!-- Pricing Summary Overlay Card - SITTING LAYOUT (5 rows) -->
        <Grid x:Name="PricingSummaryOverlay"
              Grid.RowSpan="2"
              Background="#80000000"
              Visibility="Collapsed"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch"
              Panel.ZIndex="998">
            <Border Background="White" 
                    CornerRadius="8" 
                    Width="520" 
                    VerticalAlignment="Center" 
                    HorizontalAlignment="Center"
                    Padding="30"
                    PreviewMouseLeftButtonDown="OverlayCard_PreviewMouseDown">
                <Grid VerticalAlignment="Center">
                    <StackPanel VerticalAlignment="Center">
                        <!-- Title -->
                        <TextBlock Text="Booking Summary" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   Foreground="#333" 
                                   Margin="0,0,0,20"/>

                        <!-- Row 1: Number of Persons -->
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Number of Persons" FontSize="14" Foreground="#666" Grid.Column="0"/>
                            <TextBlock x:Name="summaryPersons" Text="0" FontSize="14" FontWeight="SemiBold" Foreground="#333" Grid.Column="1"/>
                        </Grid>

                        <!-- Row 2: Seat Type -->
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Seat Type" FontSize="14" Foreground="#666" Grid.Column="0"/>
                            <TextBlock x:Name="summarySeatType" Text="-" FontSize="14" FontWeight="SemiBold" Foreground="#333" Grid.Column="1"/>
                        </Grid>

                        <!-- Row 3: Per Person Price -->
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Per Person Price (₹)" FontSize="14" Foreground="#666" Grid.Column="0"/>
                            <TextBlock x:Name="summaryPrice" Text="0" FontSize="14" FontWeight="SemiBold" Foreground="#333" Grid.Column="1"/>
                        </Grid>

                        <!-- Row 4: Start Time and End Time -->
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Start Time -->
                            <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                <TextBlock Text="Start Time" FontSize="12" Foreground="#666" Margin="0,0,0,4"/>
                                <TextBox x:Name="summaryStartTime"
                                         Text="00:00"
                                         FontSize="13"
                                         FontWeight="SemiBold"
                                         Foreground="Black"
                                         Padding="8,6"
                                         Background="White"
                                         BorderBrush="#CCCCCC"
                                         BorderThickness="1"
                                         IsReadOnly="True"
                                         Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                                         TextAlignment="Center"/>
                            </StackPanel>

                            <!-- End Time -->
                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                <TextBlock Text="End Time" FontSize="12" Foreground="#666" Margin="0,0,0,4"/>
                                <TextBox x:Name="summaryEndTime"
                                         Text="00:00"
                                         FontSize="13"
                                         FontWeight="SemiBold"
                                         Foreground="Black"
                                         Padding="8,6"
                                         Background="White"
                                         BorderBrush="#CCCCCC"
                                         BorderThickness="1"
                                         IsReadOnly="True"
                                         Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                                         TextAlignment="Center"/>
                            </StackPanel>
                        </Grid>

                        <!-- Row 5: Total Hours (ComboBox Style) -->
                        <StackPanel Margin="0,0,0,15">
                            <TextBlock Text="Total Hours" FontWeight="SemiBold" FontSize="14" Foreground="#333" Margin="0,0,0,8"/>
                            <ComboBox x:Name="summaryHoursCombo"
                                    Height="40"
                                    Padding="10,0"
                                    FontSize="14"
                                    PreviewKeyDown="Control_PreviewKeyDown"
                                    Foreground="Black" FontWeight="DemiBold"
                                    Background="White"
                                    HorizontalContentAlignment="Left"
                                    VerticalContentAlignment="Center"
                                    MaxDropDownHeight="250"
                                    Style="{StaticResource WhiteComboBoxStyle}"
                                    SelectionChanged="SummaryHours_SelectionChanged"
                                    DropDownOpened="SummaryHours_DropDownOpened"
                                    IsTabStop="True">
                                <ComboBoxItem x:Name="summaryHoursPlaceholder" Content="Select hours" IsEnabled="False" Style="{StaticResource WhiteComboBoxItemStyle}" IsSelected="True"/>
                                <ComboBoxItem Content="1 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="2 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="3 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="4 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="5 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="6 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="7 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="8 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="9 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="10 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="11 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                                <ComboBoxItem Content="12 hr" Style="{StaticResource WhiteComboBoxItemStyle}"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- Row 6: Room Number (Sleeper Only) -->
                        <Grid x:Name="roomNumberGrid" Margin="0,0,0,15" Visibility="Collapsed">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Room Number" FontSize="14" Foreground="#666" Grid.Column="0"/>
                            <TextBox x:Name="summaryRoomNumber"
                                     Text=""
                                     FontSize="14"
                                     FontWeight="SemiBold"
                                     Foreground="Black"
                                     Grid.Column="1"
                                     Padding="10,5"
                                     Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                                     Tag="Room #"
                                     PreviewTextInput="NumbersOnly_PreviewTextInput"
                                     DataObject.Pasting="NumbersOnly_Pasting"
                                     KeyDown="SummaryCard_KeyDown"
                                     TextChanged="SummaryRoomNumber_TextChanged"
                                     IsTabStop="True"/>
                        </Grid>

                        <!-- Row 7: Discount -->
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Discount (₹)" FontSize="14" Foreground="#666" Grid.Column="0"/>
                            <TextBox x:Name="summaryDiscount" 
                                     Text="0" 
                                     FontSize="14" 
                                     FontWeight="SemiBold" 
                                     Foreground="Black"
                                     Grid.Column="1"
                                     Padding="10,5"
                                     Style="{StaticResource RoundedWatermarkTextBoxStyle}"
                                     TextChanged="SummaryDiscount_TextChanged"
                                     PreviewTextInput="NumbersOnly_PreviewTextInput"
                                     DataObject.Pasting="NumbersOnly_Pasting"
                                     KeyDown="SummaryCard_KeyDown"
                                     IsTabStop="True"/>
                        </Grid>

                        <!-- Separator Line -->
                        <Border Height="1" Background="#CCCCCC" Margin="0,10,0,15"/>

                        <!-- Row 8: Total Amount -->
                        <Grid Margin="0,0,0,25">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Total Amount (₹)" FontSize="15" FontWeight="Bold" Foreground="#333" Grid.Column="0"/>
                            <TextBlock x:Name="summaryTotalAmount" Text="0" FontSize="16" FontWeight="Bold" Foreground="#2E7D32" Grid.Column="1"/>
                        </Grid>

                        <!-- Buttons: Print and Cancel -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button x:Name="PrintButton" 
                                    Content="Print" 
                                    Height="40" 
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Grid.Column="0"
                                    Margin="0,0,10,0"
                                    Click="PrintButton_Click"
                                    IsTabStop="True"/>
                            <Button x:Name="CancelOverlayButton" 
                                    Content="Cancel" 
                                    Height="40" 
                                    Style="{StaticResource CancelButtonStyle}"
                                    Grid.Column="1"
                                    Margin="10,0,0,0"
                                    Click="CancelOverlay_Click"
                                    IsTabStop="True"/>
                        </Grid>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</UserControl>
